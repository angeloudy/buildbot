Delete with subquery is extremely slow, changing it to join
